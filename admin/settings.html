<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Settings | Fynera Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50">

  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <div class="w-64 bg-white border-r border-gray-200 p-6 flex flex-col">
      <div class="mb-10">
        <h1 class="text-2xl font-bold text-emerald-700">Fynera Admin</h1>
        <p class="text-sm text-gray-500 mt-1">Control Panel</p>
      </div>
      <nav class="space-y-2 flex-1">
        <a href="dashboard.html" class="block px-4 py-3 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Dashboard</a>
        <a href="users.html" class="block px-4 py-3 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Users</a>
        <a href="products.html" class="block px-4 py-3 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Products</a>
        <a href="requests.html" class="block px-4 py-3 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Requests</a>
        <a href="exports.html" class="block px-4 py-3 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Exports</a>
        <a href="settings.html" class="block px-4 py-3 text-sm font-medium text-emerald-700 bg-emerald-50 rounded-lg">Settings</a>
      </nav>
    </div>

    <!-- Main Content -->
    <div class="flex-1 p-8">
      <h1 class="text-3xl font-bold text-gray-900">System Settings</h1>
      <p class="text-gray-600 mt-1">Configure roles and permissions.</p>

      <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Role Management -->
        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
          <h2 class="font-semibold text-gray-900">Default Role for New Users</h2>
          <div class="mt-4 space-y-3">
            <div class="flex items-center">
              <input type="radio" id="default-buyer" name="default-role" value="buyer" class="h-4 w-4 text-emerald-600">
              <label for="default-buyer" class="ml-2 text-sm text-gray-700">Buyer</label>
            </div>
            <div class="flex items-center">
              <input type="radio" id="default-supplier" name="default-role" value="supplier" class="h-4 w-4 text-emerald-600">
              <label for="default-supplier" class="ml-2 text-sm text-gray-700">Supplier</label>
            </div>
            <div class="flex items-center">
              <input type="radio" id="default-logistics" name="default-role" value="logistics" class="h-4 w-4 text-emerald-600">
              <label for="default-logistics" class="ml-2 text-sm text-gray-700">Logistics</label>
            </div>
          </div>
          <button id="save-role" class="mt-6 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-sm font-medium">
            Save Default Role
          </button>
          <div id="role-message" class="mt-2 text-sm text-gray-500"></div>
        </div>

        <!-- Permissions -->
        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
          <h2 class="font-semibold text-gray-900">Permissions</h2>
          <p class="text-gray-600 mt-1 text-sm">Control access by role.</p>
          <div class="mt-4 space-y-4">
            <div>
              <h3 class="text-sm font-medium text-gray-700">Buyers</h3>
              <div class="mt-2 space-y-2">
                <div class="flex items-center">
                  <input type="checkbox" id="buyer-create-request" class="h-4 w-4 text-emerald-600" checked>
                  <label for="buyer-create-request" class="ml-2 text-sm text-gray-700">Create requests</label>
                </div>
                <div class="flex items-center">
                  <input type="checkbox" id="buyer-view-trends" class="h-4 w-4 text-emerald-600" checked>
                  <label for="buyer-view-trends" class="ml-2 text-sm text-gray-700">View price trends</label>
                </div>
              </div>
            </div>
            <div>
              <h3 class="text-sm font-medium text-gray-700">Suppliers</h3>
              <div class="mt-2 space-y-2">
                <div class="flex items-center">
                  <input type="checkbox" id="supplier-manage-products" class="h-4 w-4 text-emerald-600" checked>
                  <label for="supplier-manage-products" class="ml-2 text-sm text-gray-700">Manage products</label>
                </div>
                <div class="flex items-center">
                  <input type="checkbox" id="supplier-view-requests" class="h-4 w-4 text-emerald-600" checked>
                  <label for="supplier-view-requests" class="ml-2 text-sm text-gray-700">View requests</label>
                </div>
              </div>
            </div>
          </div>
          <button id="save-permissions" class="mt-6 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-sm font-medium">
            Save Permissions
          </button>
          <div id="perm-message" class="mt-2 text-sm text-gray-500"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SUPABASE_URL = 'https://zwlsikcbexouiiegiiie.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3bHNpa2NiZXhvdWlpZWdpaWllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NDQ4OTksImV4cCI6MjA3NzEyMDg5OX0.9oz9F3V7cPJe2zyBY-yb3Q9v5ZJ78GGwvcm7GHjZyEM';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Save default role to localStorage (or later to Supabase)
    document.getElementById('save-role').addEventListener('click', () => {
      const selected = document.querySelector('input[name="default-role"]:checked');
      if (selected) {
        localStorage.setItem('fynera_default_role', selected.value);
        document.getElementById('role-message').textContent = `✅ Default role set to: ${selected.value}`;
        setTimeout(() => document.getElementById('role-message').textContent = '', 3000);
      }
    });

    // Save permissions to localStorage
    document.getElementById('save-permissions').addEventListener('click', () => {
      const perms = {
        buyer: {
          createRequest: document.getElementById('buyer-create-request').checked,
          viewTrends: document.getElementById('buyer-view-trends').checked
        },
        supplier: {
          manageProducts: document.getElementById('supplier-manage-products').checked,
          viewRequests: document.getElementById('supplier-view-requests').checked
        }
      };
      localStorage.setItem('fynera_permissions', JSON.stringify(perms));
      document.getElementById('perm-message').textContent = '✅ Permissions saved';
      setTimeout(() => document.getElementById('perm-message').textContent = '', 3000);
    });

    // Load saved settings on init
    window.addEventListener('load', () => {
      const savedRole = localStorage.getItem('fynera_default_role');
      if (savedRole) {
        document.getElementById(`default-${savedRole}`).checked = true;
      }
      const savedPerms = localStorage.getItem('fynera_permissions');
      if (savedPerms) {
        const perms = JSON.parse(savedPerms);
        document.getElementById('buyer-create-request').checked = perms.buyer.createRequest;
        document.getElementById('buyer-view-trends').checked = perms.buyer.viewTrends;
        document.getElementById('supplier-manage-products').checked = perms.supplier.manageProducts;
        document.getElementById('supplier-view-requests').checked = perms.supplier.viewRequests;
      }
    });
  </script>
</body>
</html>